<!DOCTYPE html>
<html>
  <head><link rel="stylesheet" href="./css/style.css">
    <meta charset="UTF-8" />
    <title>Multi Video AR</title>
    <style>
      body { margin: 0; overflow: hidden; }
      #container { width: 100vw; height: 100vh; position: relative; }
      video { display: none; }
    </style>
    <script src="https://unpkg.com/three@0.136.0/build/three.min.js"></script>
    <script src="https://unpkg.com/mind-ar@1.1.4/dist/mindar-image-three.prod.js"></script>
  </head>
  <body>
    <div id="container" id="loadingText"></div>

    <!-- 隱藏影片元素 -->
    <video id="video0" src="./assets/video0.webm" autoplay loop muted playsinline></video>
    <video id="video1" src="./assets/video1.webm" autoplay loop muted playsinline></video>

    <script>
      const start = async () => {
        const mindarThree = new window.MINDAR.IMAGE.MindARThree({
          container: document.querySelector("#container"),
          imageTargetSrc: "./assets/target.mind"
        });
        const { renderer, scene, camera } = mindarThree;

        await mindarThree.start();
        renderer.setAnimationLoop(() => {
          renderer.render(scene, camera);
        });

        // 每個 target index 建立一個 anchor 和影片
        const videos = ["video0", "video1"];

        videos.forEach((id, index) => {
          const video = document.getElementById(id);
          const texture = new THREE.VideoTexture(video);
          const geometry = new THREE.PlaneGeometry(1, 0.5625); // 調整比例為 16:9
          const material = new THREE.MeshBasicMaterial({ map: texture, transparent: true });

          const plane = new THREE.Mesh(geometry, material);

          const anchor = mindarThree.addAnchor(index);
          anchor.group.add(plane);
        });
      };

      start();
    </script>
  </body>
</html>
